import XCTest
@testable import FirebaseVerifier

class PublicCertificateFetcherTests: XCTestCase {
    private let target = GooglePublicCertificateFetcher()

    func testFetch() throws {
        let certificates = ["2ad75b56459b73f2dc8648060d0832cf5b7fdb09": "-----BEGIN CERTIFICATE-----\nMIIDHDCCAgSgAwIBAgIIJqgM1sh8tocwDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE\nAxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMTcw\nODA3MDA0NTI2WhcNMTcwODEwMDExNTI2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl\nbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD\nggEPADCCAQoCggEBAJe3BfNDW9NEPRzdLtssFo/ZF07Se7aR1oltAxRev5IxY++Q\n/qYGzRoOJfgjp8idfS3PT6ET/Klz6kpEyjozIVTCE4Rbb/7uftlC5cKOCXMkYxh+\nUkVJ6uaPotzcHfcVv4YZ2dzCaJMPgFDLTjEyd+6DviH6ATr1o0J6wkPd7zkG+Ira\nXHB2SWSJQ84T0P7IC12uG+KDa6pdK/EAOSiYQW50ZwVkvAZr1nq2RCbz6HVfgEin\n3U8TBfuzbJXtWLSFgRvTYJMQub6BATtfWdmzV2lSEmrEO6iMzBCdrIrz9+g2Qxrp\ne1V99exULdA4NzzN0BDdSX+k+CrfflYeS+GCpGkCAwEAAaM4MDYwDAYDVR0TAQH/\nBAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ\nKoZIhvcNAQEFBQADggEBAEtoDt3cdAZ8W9bH5jZ9HFbK4MUxfcgRrsdMMiXSK1C7\n5o2HchaCIPp2XY1Z5l1ty4Gq24pimeJ1C8qHeKdPz0xQo34E5NUtT5yPD8klXPeh\nnBWJMYf4ACwfUiSlnEJ8Mnux8vSdvuI5Ql9Rp3mkeePDbcpf4geODBQrZCGJTL97\nXYvQQQX+2k9S2VebpnPjz8REBZvi1xOBpk3BR4jFeskWnAxZxBpJ5Ebr3yKxdhaE\nQ3uAfQdGlBnfziG4gM0rj8LAWZZYkeaFH9R2+bFAOXH24r77HhxOLYZ76YD1cSiD\nZLLOxcb2paSGiFJXedwpl0REYQb7bZEKi1IBaTTLZIc=\n-----END CERTIFICATE-----\n",
                            "46a4cc9c082a8b0df08918f6f6fa115b6f7bd813": "-----BEGIN CERTIFICATE-----\nMIIDHDCCAgSgAwIBAgIIMA+nEN5Ros8wDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE\nAxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMTcw\nODA1MDA0NTI2WhcNMTcwODA4MDExNTI2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl\nbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD\nggEPADCCAQoCggEBALH0XJ4aC//uNDD3Oz6yHwyba4eujO6o7esZyLuRYsGRRSKe\nasyTkxHkEbc0PPfnBHSo0x0+emVNSDCbnbP9UjTKB4mmO5aX38YEaWO0+Jbchgqz\nzu//UtKEy2kd7ORWr71MvuAc4Lc6nzwOqEu242J/tArsvVieJ+oVAJlRsPrELuxQ\nFqNrgDSoweb+2htNUI8pmxdrStDJ7/9GE60cmcPD7DnSh8mqi0LMTZFHJGGYZsM8\ni8uYnNeTU3C9dtO+xbGDjaaqLkTUprPCEjEjkFKw5LNuSYI9WbPKKwSVxLG/bLRt\nvKLYGQO24HjXhnac3YkmlIshvYkU8QeqYBr9kPsCAwEAAaM4MDYwDAYDVR0TAQH/\nBAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ\nKoZIhvcNAQEFBQADggEBAGpMD2GLFECInJSvxzMdNV7vLyGglFPaW0Eg1K+i8iQh\nOkeEwT8cqdKLKhk19TZ0XvSaiDVQAGecPwJYWDVUbs9Q9aUAhR2iwpUkHCJei5jT\nL5/iYpeFItEzEIDQaBRFVxL8vLnQoKlAkdrXxdmywzfiWGH9dFquC9c6DDXd5ztb\nVTtWiu4cs7Mf+wru+edINVHo8dxrRvfF2Cp0+riZhhjuoa4nq2AdutV7lF5tA7iY\n6U65YWEmKG5nd3p0CYRZLkbp1VP7LwdOPfwBVE7WtFpTRqh6vZL+LUgJwSMBzc84\n8zJl74g2TtOJqs+m3Rc9AmmqZI7uNJw1r4hbazNAzWc=\n-----END CERTIFICATE-----\n"]
        let result = try target.fetch(with: "46a4cc9c082a8b0df08918f6f6fa115b6f7bd813", from: certificates)
        XCTAssertEqual(result, "MIIDHDCCAgSgAwIBAgIIMA+nEN5Ros8wDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UEAxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMTcwODA1MDA0NTI2WhcNMTcwODA4MDExNTI2WjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tlbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALH0XJ4aC//uNDD3Oz6yHwyba4eujO6o7esZyLuRYsGRRSKeasyTkxHkEbc0PPfnBHSo0x0+emVNSDCbnbP9UjTKB4mmO5aX38YEaWO0+Jbchgqzzu//UtKEy2kd7ORWr71MvuAc4Lc6nzwOqEu242J/tArsvVieJ+oVAJlRsPrELuxQFqNrgDSoweb+2htNUI8pmxdrStDJ7/9GE60cmcPD7DnSh8mqi0LMTZFHJGGYZsM8i8uYnNeTU3C9dtO+xbGDjaaqLkTUprPCEjEjkFKw5LNuSYI9WbPKKwSVxLG/bLRtvKLYGQO24HjXhnac3YkmlIshvYkU8QeqYBr9kPsCAwEAAaM4MDYwDAYDVR0TAQH/BAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJKoZIhvcNAQEFBQADggEBAGpMD2GLFECInJSvxzMdNV7vLyGglFPaW0Eg1K+i8iQhOkeEwT8cqdKLKhk19TZ0XvSaiDVQAGecPwJYWDVUbs9Q9aUAhR2iwpUkHCJei5jTL5/iYpeFItEzEIDQaBRFVxL8vLnQoKlAkdrXxdmywzfiWGH9dFquC9c6DDXd5ztbVTtWiu4cs7Mf+wru+edINVHo8dxrRvfF2Cp0+riZhhjuoa4nq2AdutV7lF5tA7iY6U65YWEmKG5nd3p0CYRZLkbp1VP7LwdOPfwBVE7WtFpTRqh6vZL+LUgJwSMBzc848zJl74g2TtOJqs+m3Rc9AmmqZI7uNJw1r4hbazNAzWc=")
    }
}
